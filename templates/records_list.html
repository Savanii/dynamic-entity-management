{% extends "base.html" %}
{% block content %}

<div class="card shadow-sm">
    <div class="card-header bg-info text-white">
        Records for: {{ entity[0] }}
    </div>
    <div class="card-body">

        <!-- FILTER FORM -->
        <form method="POST" action="/records-list/{{ entity_type_id }}" class="row g-3 mb-4">

            <div class="col-md-3">
                <select name="attribute_id" class="form-select">
                    {% for attr in attributes %}
                    <option value="{{ attr[0] }}">{{ attr[1] }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="col-md-2">
                <select name="operator" class="form-select">
                    <option value="=">=</option>
                    <option value=">">></option>
                    <option value="<"><</option>
                    <option value="LIKE">LIKE</option>
                </select>
            </div>

            <div class="col-md-3">
                <input type="text" name="value"
                       class="form-control"
                       placeholder="Enter value"
                       required>
            </div>

            <div class="col-md-2">
                <button type="submit" class="btn btn-primary">
                    Filter
                </button>
            </div>

        </form>

        <a href="/records/{{ entity_type_id }}" class="btn btn-success mb-3">
            Create New Record
        </a>

        {% if records %}
        <table class="table table-bordered table-hover">
            <thead class="table-dark">
                <tr>
                    <th style="width:80px;">ID</th>
                    {% for attr in attributes %}
                    <th>{{ attr[1] }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for entity_id, values in records.items() %}
                <tr>
                    <td>{{ entity_id }}</td>

                    {% for attr in attributes %}
                    <td>{{ values.get(attr[1], '') }}</td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <div class="alert alert-info">
            No records found.
        </div>
        {% endif %}

        <a href="/attributes/{{ entity_type_id }}" class="btn btn-secondary mt-3">
            Back
        </a>

    </div>
</div>

{% endblock %}